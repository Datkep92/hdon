<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng CasNa</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <div class="sidebar">
        <div class="sidebar-header">
            <h3>DANH S√ÅCH C√îNG TY</h3>
        </div>
        <div class="company-list" id="company-list">
            <div class="company-item">Ch∆∞a c√≥ d·ªØ li·ªáu</div>
        </div>
        <div class="sidebar-footer" style="padding: 20px; border-top: 1px solid #ddd;">
    <button id="clear-all-data" class="btn-danger" style="width: 100%;">
        üóëÔ∏è X√≥a H·∫øt D·ªØ Li·ªáu
    </button>
</div>
    
    <!-- Th√™m n√∫t debug (t√πy ch·ªçn) -->
    <button onclick="debugDataStatus()" class="btn-secondary" style="width: 100%; margin-top: 10px; font-size: 12px;">
        üîç Debug Data
    </button>
</div>
    
    <div class="main-content">
        <div class="header">
            <div class="header-content">
        
                <div class="current-company" id="current-company">Ch·ªçn c√¥ng ty ƒë·ªÉ xem th√¥ng tin</div>
            </div>
        </div>
        
        <!-- Menu ngang 8 tab (th√™m tab Convert) -->
        <div class="nav-tabs">
            <div class="nav-tab" data-tab="xu-ly-hoa-don-loi">X·ª≠ L√Ω H√≥a ƒê∆°n</div>
            <div class="nav-tab" data-tab="mua-hang">Mua H√†ng</div>
            <div class="nav-tab" data-tab="kho-hang">Kho H√†ng</div>
            <div class="nav-tab" data-tab="ban-hang">B√°n H√†ng</div>
            <div class="nav-tab" data-tab="tien-cong-no">Ti·ªÅn & C√¥ng N·ª£</div>
            <div class="nav-tab" data-tab="thue-bao-cao">Thu·∫ø & B√°o C√°o</div>
            <div class="nav-tab" data-tab="so-sach">S·ªï S√°ch</div>
            <div class="nav-tab" data-tab="so-du-dau-ky">S·ªë D∆∞ ƒê·∫ßu K·ª≥</div>
            <div class="nav-tab" data-tab="convert">Convert</div>
        </div>
        
        <!-- Th√™m n·ªôi dung tab -->
        <div class="tab-content" id="xu-ly-hoa-don-loi">
            <!-- N·ªôi dung tab X·ª≠ L√Ω H√≥a ƒê∆°n L·ªói (gi·ªØ nguy√™n) -->
            <div class="content-body">
                <div class="card">
                    <div class="card-header">üìä Th·ªëng K√™ H√≥a ƒê∆°n L·ªói</div>
                    <div id="error-invoice-stats">
                        <!-- Th·ªëng k√™ s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">üîç Danh S√°ch H√≥a ƒê∆°n C·∫ßn S·ª≠a</div>
                    <div class="form-group">
                        <input type="text" id="search-error-invoices" placeholder="T√¨m ki·∫øm h√≥a ƒë∆°n l·ªói...">
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>S·ªë Hƒê</th>
                                <th>Ng√†y</th>
                                <th>Nh√† cung c·∫•p</th>
                                <th>MST NCC</th>
                                <th>T·ªïng ti·ªÅn</th>
                                <th>Ch√™nh l·ªách</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="error-invoice-list">
                            <tr><td colspan="9" style="text-align: center;">Ch∆∞a c√≥ h√≥a ƒë∆°n l·ªói</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">üìà H√≥a ƒê∆°n ƒê√£ X·ª≠ L√Ω</div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>S·ªë Hƒê</th>
                                <th>Ng√†y s·ª≠a</th>
                                <th>Ng∆∞·ªùi s·ª≠a</th>
                                <th>Ch√™nh l·ªách tr∆∞·ªõc/sau</th>
                                <th>K·∫øt qu·∫£</th>
                            </tr>
                        </thead>
                        <tbody id="processed-invoice-list">
                            <tr><td colspan="5" style="text-align: center;">Ch∆∞a c√≥ h√≥a ƒë∆°n ƒë√£ x·ª≠ l√Ω</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tab Convert (m·ªõi th√™m) -->
        <div class="tab-content" id="convert">
            <div class="content-body">
    <div class="card">
        <div class="card-header">
            <h3>Chuy·ªÉn ƒë·ªïi VNPT/VIETTEL sang MISA</h3>
            <p class="subtitle">Upload file VNPT v√† file m√£ h√†ng MISA ƒë·ªÉ chuy·ªÉn ƒë·ªïi t·ª± ƒë·ªông</p>
        </div>
        
        <!-- N√öT T·∫¢I FILE M·∫™U -->
        <div class="section" style="background: #e8f5e8; border-left: 4px solid #28a745;">
            <h4>üì• T·∫¢I FILE M·∫™U</h4>
            <p><strong>Download file M√É Hang - T√™n H√†ng:</strong></p>
            <button onclick="downloadMISASample()" class="btn" style="background: #28a745; color: white;">
                ‚¨áÔ∏è T·∫£i File
            </button>
            <p style="margin-top: 10px; font-size: 0.5em; color: #666;">
                File m·∫´u c√≥ 2 c·ªôt: <strong>M√£ h√†ng</strong> v√† <strong>T√™n h√†ng</strong>
            </p>
        </div>
        
        <!-- B∆Ø·ªöC 1: UPLOAD FILE VNPT -->
        <div class="section">
            <h4>1. Upload file VNPT/VIETTEL</h4>
            <input type="file" id="vnptFile" class="file-input" accept=".xlsx, .xls">
            <div id="vnptPreview" class="preview">Ch∆∞a c√≥ file VNPT n√†o ƒë∆∞·ª£c ch·ªçn</div>
        </div>
        
        <!-- B∆Ø·ªöC 2: UPLOAD FILE MAPPING MISA -->
        <div class="section">
            <h4>2. Upload file m√£ h√†ng MISA</h4>
            <p><strong>ƒê·ªãnh d·∫°ng:</strong> File Excel c√≥ 2 c·ªôt "M√£ h√†ng" v√† "T√™n h√†ng"</p>
            <input type="file" id="misaMappingFile" class="file-input" accept=".xlsx, .xls">
            <div id="mappingStatus" class="status info">Ch∆∞a c√≥ file MISA n√†o ƒë∆∞·ª£c ch·ªçn</div>
            <div id="mappingPreview" class="preview">Danh s√°ch m√£ h√†ng s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</div>
        </div>
        
        <!-- B∆Ø·ªöC 3: X·ª¨ L√ù -->
        <div class="actions">
            <button id="processBtn" class="btn" disabled>X·ª≠ l√Ω chuy·ªÉn ƒë·ªïi</button>
            <button id="downloadBtn" class="btn btn-success" disabled>T·∫£i file MISA</button>
        </div>
        
        <!-- B∆Ø·ªöC 4: K·∫æT QU·∫¢ -->
        <div class="result-section">
            <h4>K·∫øt qu·∫£ chuy·ªÉn ƒë·ªïi</h4>
            <div id="processResult" class="status info">Ch∆∞a x·ª≠ l√Ω</div>
            <div id="resultSummary"></div>
            <div id="newProductsList"></div>
        </div>
    </div>
</div>
        </div>
        
        <!-- C√°c tab kh√°c gi·ªØ nguy√™n -->
        <div class="tab-content active" id="so-du-dau-ky">
            <!-- N·ªôi dung tab S·ªë D∆∞ ƒê·∫ßu K·ª≥ (gi·ªØ nguy√™n) -->
            <div class="content-body">
                <div class="card">
                    <div class="card-header">Nh·∫≠p S·ªë D∆∞ ƒê·∫ßu K·ª≥</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="opening-stock">T·ªìn kho ƒë·∫ßu k·ª≥</label>
                            <input type="number" id="opening-stock" placeholder="Nh·∫≠p gi√° tr·ªã t·ªìn kho">
                        </div>
                        <div class="form-group">
                            <label for="opening-cash">T·ªìn qu·ªπ ti·ªÅn m·∫∑t</label>
                            <input type="number" id="opening-cash" placeholder="Nh·∫≠p s·ªë d∆∞ ti·ªÅn m·∫∑t">
                        </div>
                        <div class="form-group">
                            <label for="opening-bank">S·ªë d∆∞ ti·ªÅn g·ª≠i ng√¢n h√†ng</label>
                            <input type="number" id="opening-bank" placeholder="Nh·∫≠p s·ªë d∆∞ ng√¢n h√†ng">
                        </div>
                        <div class="form-group">
                            <label for="opening-receivable">C√¥ng n·ª£ ph·∫£i thu ƒë·∫ßu k·ª≥ (131)</label>
                            <input type="number" id="opening-receivable" placeholder="Nh·∫≠p c√¥ng n·ª£ ph·∫£i thu">
                        </div>
                        <div class="form-group">
                            <label for="opening-payable">C√¥ng n·ª£ ph·∫£i tr·∫£ ƒë·∫ßu k·ª≥ (331)</label>
                            <input type="number" id="opening-payable" placeholder="Nh·∫≠p c√¥ng n·ª£ ph·∫£i tr·∫£">
                        </div>
                    </div>
                    <div class="card-footer">
                        <button id="save-opening-balance" class="btn-success">L∆∞u S·ªë D∆∞ ƒê·∫ßu K·ª≥</button>
                        <button id="print-opening-balance" class="btn-primary">In B·∫£ng S·ªë D∆∞</button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">T√†i S·∫£n C·ªë ƒê·ªãnh / CCDC</div>
                    <div id="fixed-assets-container">
                        <!-- Danh s√°ch t√†i s·∫£n c·ªë ƒë·ªãnh s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                    </div>
                    <div class="card-footer">
                        <button id="add-fixed-asset" class="btn-success">Th√™m T√†i S·∫£n</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab Mua H√†ng -->
        <div class="tab-content" id="mua-hang">
            
            <div class="content-body">
                <div class="card">
                    <div class="card-header">1. Nh·∫≠p H√≥a ƒê∆°n Mua H√†ng (XML/ZIP)</div>
                    <div class="form-group">
                        <input type="file" id="purchase-invoice-files" multiple accept=".zip, .xml">
                    </div>
                    <button id="process-purchase-invoices" class="btn-primary">Tr√≠ch Xu·∫•t H√≥a ƒê∆°n</button>
                </div>
                
                <div class="card">
                    <div class="card-header">2. Danh S√°ch H√≥a ƒê∆°n Mua H√†ng</div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>STT</th>
                                <th>S·ªë Hƒê</th>
                                <th>Ng√†y</th>
                                <th>Nh√† cung c·∫•p</th>
                                <th>MST NCC</th>
                                <th>T·ªïng ti·ªÅn</th>
                                <th>Thu·∫ø GTGT</th>
                                <th>Tr·∫°ng th√°i</th>
                                <th>Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="purchase-invoice-list">
                            <tr><td colspan="9" style="text-align: center;">Ch∆∞a c√≥ h√≥a ƒë∆°n mua h√†ng</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">3. C√¥ng N·ª£ Ph·∫£i Tr·∫£ NCC (331)</div>
                    <table class="table">
                       
                        <tbody id="payable-list">
                            <tr><td colspan="6" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu c√¥ng n·ª£</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">In Ch·ª©ng T·ª´</div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="printPurchaseInvoices()">In H√≥a ƒê∆°n ƒê·∫ßu V√†o</button>
                        <button class="btn-primary" onclick="printPurchaseReceipts()">In Phi·∫øu Nh·∫≠p Kho</button>
                        <button class="btn-primary" onclick="printPurchaseLedger()">In S·ªï Chi Ti·∫øt Mua H√†ng</button>
                    </div>
                </div>
            </div>
        </div>

       <!-- Tab Kho H√†ng -->
<div class="tab-content" id="kho-hang">
    <div class="content-body">
        <!-- C·∫£nh b√°o t·ªìn kho s·∫Ω ƒë∆∞·ª£c th√™m ·ªü ƒë√¢y b·∫±ng JavaScript -->

        <!-- Danh M·ª•c H√†ng H√≥a -->
        <div class="card">
            <div class="card-header">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h5 style="margin: 0;">Danh M·ª•c H√†ng H√≥a</h5>
                    <div id="catalog-summary" style="margin-left: auto; font-size: 14px; color: #666;">
                        <!-- JavaScript s·∫Ω c·∫≠p nh·∫≠t n·ªôi dung ·ªü ƒë√¢y -->
                    </div>
                </div>
            </div>
            <div class="card-body">
                <!-- B·ªô l·ªçc ng√†y -->
                <div class="form-group" style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="stock-date-start" style="margin: 0; white-space: nowrap;">T·ª´ ng√†y:</label>
                        <input type="date" id="stock-date-start" class="form-control" style="width: auto;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="stock-date-end" style="margin: 0; white-space: nowrap;">ƒê·∫øn ng√†y:</label>
                        <input type="date" id="stock-date-end" class="form-control" style="width: auto;">
                    </div>
                    <button id="apply-date-filter" class="btn-sm btn-primary">√Åp d·ª•ng</button>
                    <button id="clear-date-filter" class="btn-sm btn-outline-secondary">Hi·ªán t·∫°i</button>
                    <div style="font-size: 12px; color: #666; margin-left: auto;">
                        <span id="date-filter-status">ƒêang hi·ªÉn th·ªã t·ªìn kho hi·ªán t·∫°i</span>
                    </div>
                </div>

                <div class="form-group">
                    <input type="text" id="search-products" class="form-control" placeholder="T√¨m ki·∫øm h√†ng h√≥a theo MSP ho·∫∑c t√™n...">
                </div>
                
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>MSP</th>
                            <th>T√™n h√†ng h√≥a</th>
                            <th>ƒêVT</th>
                            <th style="text-align: right;">S·ªë l∆∞·ª£ng t·ªìn</th>
                            <th style="text-align: right;">ƒê∆°n gi√°</th>
                            <th style="text-align: right;">Th√†nh ti·ªÅn</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody id="product-catalog-list">
                        <tr>
                            <td colspan="7" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu h√†ng h√≥a</td>
                        </tr>
                    </tbody>
                </table>
                
                <div id="catalog-controls" style="text-align: center; margin-top: 10px; padding: 10px; border-top: 1px solid #eee;">
                    <!-- JavaScript s·∫Ω th√™m n√∫t v√†o ƒë√¢y -->
                </div>
            </div>
        </div>


        <!-- D·ª± B√°o Nhu C·∫ßu -->
        <div class="card">
            <div class="card-header">
                <h5>üîÆ D·ª± B√°o Nhu C·∫ßu</h5>
            </div>
            <div class="card-body">
                <div class="form-group">
                    <label>S·ªë th√°ng d·ª± b√°o:</label>
                    <select id="forecast-months" class="form-control">
                        <option value="1">1 th√°ng</option>
                        <option value="2">2 th√°ng</option>
                        <option value="3">3 th√°ng</option>
                    </select>
                </div>
                <button onclick="generateDemandForecast()" class="btn-primary">T·∫°o D·ª± B√°o</button>
                <div id="forecast-result" style="margin-top: 15px;"></div>
            </div>
        </div>

        <!-- Hi·ªáu Su·∫•t Kho -->
        <div class="card">
            <div class="card-header">
                <h5>üìà Hi·ªáu Su·∫•t Kho</h5>
            </div>
            <div class="card-body">
                <div class="performance-stats" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                    <div class="stat-card" style="background: #e8f5e8; padding: 15px; border-radius: 4px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #28a745;" id="turnover-rate">0%</div>
                        <div style="font-size: 12px;">T·ª∑ l·ªá xoay v√≤ng</div>
                    </div>
                    <div class="stat-card" style="background: #fff3cd; padding: 15px; border-radius: 4px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #ffc107;" id="total-sku">0</div>
                        <div style="font-size: 12px;">SKU t·ªìn kho</div>
                    </div>
                    <div class="stat-card" style="background: #f8d7da; padding: 15px; border-radius: 4px; text-align: center;">
                        <div style="font-size: 24px; font-weight: bold; color: #dc3545;" id="low-stock-sku">0</div>
                        <div style="font-size: 12px;">SKU s·∫Øp h·∫øt</div>
                    </div>
                </div>
                <button onclick="generatePerformanceReport()" class="btn-primary" style="margin-top: 15px;">T·∫°o B√°o C√°o Hi·ªáu Su·∫•t</button>
            </div>
        </div>

        <!-- Th·∫ª Kho Chi Ti·∫øt -->
        <div class="card">
            <div class="card-header">Th·∫ª Kho Chi Ti·∫øt</div>
            <div id="stock-card-container">
                <p style="text-align: center; padding: 20px; color: #666;">
                    Th·∫ª kho s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y. Click v√†o MSP trong b·∫£ng tr√™n ƒë·ªÉ xem th·∫ª kho chi ti·∫øt.
                </p>
            </div>
        </div>
        
        <!-- B√°o C√°o T·ªìn Kho -->
        <div class="card">
            <div class="card-header">B√°o C√°o T·ªìn Kho Theo Kho·∫£ng Th·ªùi Gian</div>
            <div class="card-body">
                <div class="form-group" style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="report-date-start" style="margin: 0; white-space: nowrap;">T·ª´ ng√†y:</label>
                        <input type="date" id="report-date-start" class="form-control" style="width: auto;">
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px;">
                        <label for="report-date-end" style="margin: 0; white-space: nowrap;">ƒê·∫øn ng√†y:</label>
                        <input type="date" id="report-date-end" class="form-control" style="width: auto;">
                    </div>
                    <button id="generate-stock-report" class="btn-primary">T·∫°o B√°o C√°o T·ªìn Kho</button>
                </div>
                <div id="stock-report-result" class="hidden" style="margin-top: 20px;">
                    <!-- K·∫øt qu·∫£ b√°o c√°o t·ªìn kho s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                </div>
            </div>
        </div>
        
        <!-- In Ch·ª©ng T·ª´ -->
        <div class="card">
            <div class="card-header">In Ch·ª©ng T·ª´</div>
            <div class="card-body">
                <div class="button-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn-primary" onclick="printStockCards()">In Th·∫ª Kho</button>
                    <button class="btn-primary" onclick="printStockLedger()">In S·ªï Nh·∫≠p-Xu·∫•t-T·ªìn</button>
                    <button class="btn-primary" onclick="printStockReport()">In B√°o C√°o T·ªìn Kho</button>
                </div>
            </div>
        </div>
    </div>
</div>

        <!-- Tab B√°n H√†ng -->
<div class="tab-content" id="ban-hang">
    <div class="content-body">
        <div class="card">
            <div class="card-header">
                <h5>üõí T·∫°o ƒê∆°n B√°n H√†ng</h5>
            </div>
            <div class="card-body">
                <!-- Th√¥ng tin kh√°ch h√†ng -->
                <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label for="sale-customer">T√™n kh√°ch h√†ng *</label>
                        <input type="text" id="sale-customer" class="form-control" placeholder="Nh·∫≠p t√™n kh√°ch h√†ng">
                    </div>
                    <div class="form-group">
                        <label for="sale-phone">S·ªë ƒëi·ªán tho·∫°i</label>
                        <input type="text" id="sale-phone" class="form-control" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i">
                    </div>
                    <div class="form-group">
                        <label for="sale-taxcode">M√£ s·ªë thu·∫ø</label>
                        <input type="text" id="sale-taxcode" class="form-control" placeholder="Nh·∫≠p MST">
                    </div>
                    <div class="form-group">
                        <label for="sale-address">ƒê·ªãa ch·ªâ</label>
                        <input type="text" id="sale-address" class="form-control" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ">
                    </div>
                    <div class="form-group">
                        <label for="sale-date">Ng√†y b√°n *</label>
                        <input type="date" id="sale-date" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="sale-payment-method">Ph∆∞∆°ng th·ª©c thanh to√°n *</label>
                        <select id="sale-payment-method" class="form-control">
                            <option value="cash">Ti·ªÅn m·∫∑t</option>
                            <option value="bank">Chuy·ªÉn kho·∫£n</option>
                            <option value="credit">C√¥ng n·ª£</option>
                        </select>
                    </div>
                </div>

                <!-- N√∫t t·∫°o ƒë∆°n v√† th√¥ng tin t·ªïng -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 4px;">
                    <div>
                        <button id="create-sale-order" class="btn-success" style="font-size: 16px; padding: 10px 20px;">
                            üõçÔ∏è T·∫°o ƒê∆°n B√°n H√†ng
                        </button>
                    </div>
                    <div style="text-align: right;">
                        <div style="font-size: 14px; color: #666;">T·ªïng ti·ªÅn:</div>
                        <div id="total-sale-display" style="font-size: 24px; font-weight: bold; color: #28a745;">0</div>
                    </div>
                </div>

                <!-- B·ªô l·ªçc v√† ƒëi·ªÅu ch·ªânh gi√° -->
                <div class="form-grid" style="grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div class="form-group">
                        <label for="sale-product-search">üîç T√¨m ki·∫øm s·∫£n ph·∫©m</label>
                        <input type="text" id="sale-product-search" class="form-control" placeholder="T√¨m theo MSP, t√™n...">
                    </div>
                    <div class="form-group">
                        <label for="sale-margin">üìà % L·ª£i nhu·∫≠n mong mu·ªën</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" id="sale-margin" class="form-control" value="20" min="0" max="100" step="1" style="width: 100px;">
                            <button onclick="applyMarginToAll()" class="btn-sm btn-primary">√Åp d·ª•ng</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: block; margin-bottom: 5px;">Thao t√°c nhanh</label>
                        <div style="display: flex; gap: 5px;">
                            <button onclick="selectAllProducts()" class="btn-sm btn-outline-primary">Ch·ªçn t·∫•t c·∫£</button>
                            <button onclick="deselectAllProducts()" class="btn-sm btn-outline-secondary">B·ªè ch·ªçn</button>
                        </div>
                    </div>
                </div>

                <!-- Danh s√°ch s·∫£n ph·∫©m -->
                <div class="card">
                    <div class="card-header" style="display: flex; justify-content: space-between; align-items: center;">
                        <h6 style="margin: 0;">üì¶ Ch·ªçn S·∫£n Ph·∫©m B√°n</h6>
                        <div id="sale-summary" style="font-size: 14px; color: #666;">
                            <span id="selected-count">0</span> s·∫£n ph·∫©m ƒë∆∞·ª£c ch·ªçn | 
                            T·ªïng: <span id="header-total-amount">0</span>
                        </div>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div id="sale-products-container">
                            <!-- Danh s√°ch s·∫£n ph·∫©m s·∫Ω ƒë∆∞·ª£c load b·∫±ng JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- C√°c ph·∫ßn c√≤n l·∫°i gi·ªØ nguy√™n -->
        <div class="card">
            <div class="card-header">Danh S√°ch ƒê∆°n B√°n H√†ng</div>
            <table class="table">
                <thead>
                    <tr>
                        <th>M√£ ƒë∆°n</th>
                        <th>Ng√†y</th>
                        <th>Kh√°ch h√†ng</th>
                        <th>ƒêi·ªán tho·∫°i</th>
                        <th>T·ªïng ti·ªÅn</th>
                        <th>Tr·∫°ng th√°i</th>
                        <th>Thao t√°c</th>
                    </tr>
                </thead>
                <tbody id="sale-orders-list">
                    <tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ ƒë∆°n b√°n h√†ng</td></tr>
                </tbody>
            </table>
        </div>
        
        <div class="card">
            <div class="card-header">C√¥ng N·ª£ Ph·∫£i Thu KH (131)</div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Kh√°ch h√†ng</th>
                        <th>ƒêi·ªán tho·∫°i</th>
                        <th>MST</th>
                        <th>T·ªïng n·ª£</th>
                        <th>ƒê√£ thu</th>
                        <th>C√≤n n·ª£</th>
                        <th>Thao t√°c</th>
                    </tr>
                </thead>
                <tbody id="receivable-list">
                    <tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu c√¥ng n·ª£</td></tr>
                </tbody>
            </table>
        </div>
        
        <div class="card">
            <div class="card-header">In Ch·ª©ng T·ª´</div>
            <div class="button-group">
                <button class="btn-primary" onclick="printSaleOrders()">In ƒê∆°n H√†ng</button>
                <button class="btn-primary" onclick="printSaleInvoices()">In H√≥a ƒê∆°n ƒê·∫ßu Ra</button>
                <button class="btn-primary" onclick="printSaleReport()">In B√°o C√°o Doanh Thu</button>
            </div>
        </div>
    </div>
</div>

        <!-- Tab Ti·ªÅn & C√¥ng N·ª£ -->
        <div class="tab-content" id="tien-cong-no">
            
            <div class="content-body">
                <div class="card">
                    <div class="card-header">Phi·∫øu Thu - Phi·∫øu Chi (111)</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="voucher-type">Lo·∫°i ch·ª©ng t·ª´</label>
                            <select id="voucher-type">
                                <option value="receipt">Phi·∫øu thu</option>
                                <option value="payment">Phi·∫øu chi</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="voucher-date">Ng√†y</label>
                            <input type="date" id="voucher-date">
                        </div>
                        <div class="form-group">
                            <label for="voucher-amount">S·ªë ti·ªÅn</label>
                            <input type="number" id="voucher-amount" placeholder="Nh·∫≠p s·ªë ti·ªÅn">
                        </div>
                        <div class="form-group">
                            <label for="voucher-description">Di·ªÖn gi·∫£i</label>
                            <input type="text" id="voucher-description" placeholder="N·ªôi dung">
                        </div>
                    </div>
                    <div class="card-footer">
                        <button id="create-voucher" class="btn-success">T·∫°o Ch·ª©ng T·ª´</button>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">S·ªï Qu·ªπ Ti·ªÅn M·∫∑t</div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Ng√†y</th>
                                <th>Di·ªÖn gi·∫£i</th>
                                <th>Thu</th>
                                <th>Chi</th>
                                <th>T·ªìn</th>
                            </tr>
                        </thead>
                        <tbody id="cash-book-list">
                            <tr><td colspan="5" style="text-align: center;">Ch∆∞a c√≥ giao d·ªãch</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">S·ªï Ti·ªÅn G·ª≠i Ng√¢n H√†ng</div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Ng√†y</th>
                                <th>Ng√¢n h√†ng</th>
                                <th>S·ªë TK</th>
                                <th>Di·ªÖn gi·∫£i</th>
                                <th>Thu</th>
                                <th>Chi</th>
                                <th>T·ªìn</th>
                            </tr>
                        </thead>
                        <tbody id="bank-book-list">
                            <tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ giao d·ªãch</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">B·∫£ng Tu·ªïi N·ª£ (Aging)</div>
                    <div id="aging-report-container">
                        <!-- B·∫£ng tu·ªïi n·ª£ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">In Ch·ª©ng T·ª´</div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="printReceipts()">In Phi·∫øu Thu</button>
                        <button class="btn-primary" onclick="printPayments()">In Phi·∫øu Chi</button>
                        <button class="btn-primary" onclick="printCashBook()">In S·ªï Qu·ªπ</button>
                        <button class="btn-primary" onclick="printBankStatement()">In Sao K√™ Ng√¢n H√†ng</button>
                        <button class="btn-primary" onclick="printAgingReport()">In B·∫£ng Tu·ªïi N·ª£</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Thu·∫ø & B√°o C√°o -->
        <div class="tab-content" id="thue-bao-cao">
            
            <div class="content-body">
                <div class="card">
                    <div class="card-header">S·ªï Thu·∫ø GTGT</div>
                    <div class="tax-tabs">
                        <button class="tax-tab-btn active" onclick="showTaxTab('vat-input')">ƒê·∫ßu V√†o (1331)</button>
                        <button class="tax-tab-btn" onclick="showTaxTab('vat-output')">ƒê·∫ßu Ra (1332)</button>
                        <button class="tax-tab-btn" onclick="showTaxTab('vat-summary')">T·ªïng H·ª£p Thu·∫ø</button>
                    </div>
                    
                    <div id="vat-input-tab" class="tax-tab-content active">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>K·ª≥</th>
                                    <th>S·ªë Hƒê</th>
                                    <th>Ng√†y Hƒê</th>
                                    <th>MST NCC</th>
                                    <th>Doanh thu</th>
                                    <th>Thu·∫ø GTGT</th>
                                    <th>T·ªïng thanh to√°n</th>
                                </tr>
                            </thead>
                            <tbody id="vat-input-list">
                                <tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="vat-output-tab" class="tax-tab-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>K·ª≥</th>
                                    <th>S·ªë Hƒê</th>
                                    <th>Ng√†y Hƒê</th>
                                    <th>MST KH</th>
                                    <th>Doanh thu</th>
                                    <th>Thu·∫ø GTGT</th>
                                    <th>T·ªïng thanh to√°n</th>
                                </tr>
                            </thead>
                            <tbody id="vat-output-list">
                                <tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="vat-summary-tab" class="tax-tab-content">
                        <div id="vat-summary-container">
                            <!-- T·ªïng h·ª£p thu·∫ø s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">B√°o C√°o T√†i Ch√≠nh</div>
                    <div class="financial-tabs">
                        <button class="financial-tab-btn active" onclick="showFinancialTab('balance-sheet')">Cƒê T√†i Kho·∫£n</button>
                        <button class="financial-tab-btn" onclick="showFinancialTab('transaction-balance')">Cƒê Ph√°t Sinh</button>
                        <button class="financial-tab-btn" onclick="showFinancialTab('profit-loss')">K·∫øt Qu·∫£ KD</button>
                    </div>
                    
                    <div id="balance-sheet-tab" class="financial-tab-content active">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>T√†i kho·∫£n</th>
                                    <th>T√™n t√†i kho·∫£n</th>
                                    <th>D∆∞ n·ª£ ƒë·∫ßu k·ª≥</th>
                                    <th>D∆∞ c√≥ ƒë·∫ßu k·ª≥</th>
                                    <th>Ph√°t sinh n·ª£</th>
                                    <th>Ph√°t sinh c√≥</th>
                                    <th>D∆∞ n·ª£ cu·ªëi k·ª≥</th>
                                    <th>D∆∞ c√≥ cu·ªëi k·ª≥</th>
                                </tr>
                            </thead>
                            <tbody id="balance-sheet-list">
                                <tr><td colspan="8" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="transaction-balance-tab" class="financial-tab-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>T√†i kho·∫£n</th>
                                    <th>T√™n t√†i kho·∫£n</th>
                                    <th>Ph√°t sinh n·ª£</th>
                                    <th>Ph√°t sinh c√≥</th>
                                </tr>
                            </thead>
                            <tbody id="transaction-balance-list">
                                <tr><td colspan="4" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="profit-loss-tab" class="financial-tab-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Ch·ªâ ti√™u</th>
                                    <th>Gi√° tr·ªã</th>
                                </tr>
                            </thead>
                            <tbody id="profit-loss-list">
                                <tr><td colspan="2" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">In Ch·ª©ng T·ª´</div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="printVATDeclaration()">In T·ªù Khai Thu·∫ø GTGT</button>
                        <button class="btn-primary" onclick="printCorporateTaxReport()">In B√°o C√°o Thu·∫ø TNDN</button>
                        <button class="btn-primary" onclick="printFinancialStatements()">In B√°o C√°o T√†i Ch√≠nh</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab S·ªï S√°ch -->
        <div class="tab-content" id="so-sach">
            
            <div class="content-body">
                <div class="card">
                    <div class="card-header">Nh·∫≠t K√Ω Chung</div>
                    <div class="form-group">
                        <label for="journal-period">K·ª≥ k·∫ø to√°n</label>
                        <input type="month" id="journal-period">
                    </div>
                    <button id="generate-journal" class="btn-primary">Xem Nh·∫≠t K√Ω Chung</button>
                    
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Ng√†y</th>
                                <th>Ch·ª©ng t·ª´</th>
                                <th>Di·ªÖn gi·∫£i</th>
                                <th>T√†i kho·∫£n N·ª£</th>
                                <th>T√†i kho·∫£n C√≥</th>
                                <th>S·ªë ti·ªÅn</th>
                            </tr>
                        </thead>
                        <tbody id="general-journal-list">
                            <tr><td colspan="6" style="text-align: center;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">S·ªï C√°i T√†i Kho·∫£n</div>
                    <div class="form-group">
                        <label for="ledger-account">Ch·ªçn t√†i kho·∫£n</label>
                        <select id="ledger-account">
                            <option value="111">111 - Ti·ªÅn m·∫∑t</option>
                            <option value="112">112 - Ti·ªÅn g·ª≠i ng√¢n h√†ng</option>
                            <option value="131">131 - Ph·∫£i thu kh√°ch h√†ng</option>
                            <option value="133">133 - Thu·∫ø GTGT ƒë∆∞·ª£c kh·∫•u tr·ª´</option>
                            <option value="156">156 - H√†ng h√≥a</option>
                            <option value="331">331 - Ph·∫£i tr·∫£ ng∆∞·ªùi b√°n</option>
                            <option value="333">333 - Thu·∫ø v√† c√°c kho·∫£n ph·∫£i n·ªôp</option>
                            <option value="511">511 - Doanh thu b√°n h√†ng</option>
                            <option value="632">632 - Gi√° v·ªën h√†ng b√°n</option>
                        </select>
                    </div>
                    <button id="view-ledger" class="btn-primary">Xem S·ªï C√°i</button>
                    
                    <div id="ledger-detail-container">
                        <!-- Chi ti·∫øt s·ªï c√°i s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">S·ªï Chi Ti·∫øt T√†i Kho·∫£n</div>
                    <div id="account-detail-container">
                        <!-- S·ªï chi ti·∫øt t√†i kho·∫£n s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">In Ch·ª©ng T·ª´</div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="printGeneralJournal()">In Nh·∫≠t K√Ω Chung</button>
                        <button class="btn-primary" onclick="printGeneralLedger()">In S·ªï C√°i</button>
                        <button class="btn-primary" onclick="printAccountLedger()">In S·ªï Chi Ti·∫øt TK</button>
                        <button class="btn-primary" onclick="printFinancialReports()">In B√°o C√°o T√†i Ch√≠nh</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

     <!-- Modal container -->
    <div id="custom-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Modal Title</h3>
                <span class="close" onclick="document.getElementById('custom-modal').style.display = 'none'">&times;</span>
            </div>
            <div class="modal-body" id="modal-body">
                Modal content goes here...
            </div>
        </div>
    </div>

    <script src="zip-trichxuat.js"></script>
    <script src="xulyhoadonloi.js"></script>
    <script src="hoadon.js"></script>
    <script src="sodudauky.js"></script>
    <script src="muahang.js"></script>
    <script src="khohang.js"></script>
    <script src="banhang.js"></script>
     <script src="auto-export-scheduler.js"></script>
    <script src="khachhang-ncc.js"></script>
    <script src="smart-sale-floating.js"></script>
    <script src="tiencongno.js"></script>
    <script src="thuebaocao.js"></script>
    <script src="sosach.js"></script>
    <script src="app.js"></script>
    <script src="conver.js"></script>
</body>
</html>
